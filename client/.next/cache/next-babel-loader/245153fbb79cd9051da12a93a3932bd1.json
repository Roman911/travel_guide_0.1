{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport React from \"react\";\nimport Link from \"next/link\";\nimport { useSelector } from \"react-redux\";\nimport { Formik, Form } from 'formik';\nimport { useMutation } from '@apollo/react-hooks';\nimport { css } from \"aphrodite/no-important\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faOptinMonster } from \"@fortawesome/free-brands-svg-icons\";\nimport * as Yup from 'yup';\nimport { Avatar, Button, ButtonLink, FormikControl } from \"../../../Components\";\nimport loginStyles from '../../../styles/login';\nimport styles from '../Components/styles';\nimport { CreateCommentMutation, AddCommentMutation } from './mutations';\nimport { commentsQuery } from \"./querys\";\nexport const CreateComment = ({\n  postId,\n  idComment,\n  isFirstComment,\n  handleClick\n}) => {\n  const {\n    data\n  } = useSelector(state => state.user);\n  const [createComment] = useMutation(CreateCommentMutation);\n  const [addComment] = useMutation(AddCommentMutation);\n  const initialValues = {\n    text: ''\n  };\n  const validationSchema = Yup.object({\n    text: Yup.string().min(3, 'Короткий коментар').required('Required')\n  });\n\n  const onSubmit = (values, {\n    resetForm\n  }) => {\n    const ref = [{\n      query: commentsQuery,\n      variables: {\n        postId: postId\n      }\n    }];\n    const query = {\n      variables: {\n        idAuthor: data.userId,\n        _id: idComment,\n        postId: postId,\n        text: values.text\n      },\n      refetchQueries: ref\n    };\n\n    if (isFirstComment) {\n      createComment(query).then(data => {\n        if (data) {\n          resetForm();\n        }\n      });\n    } else {\n      addComment(query).then(data => {\n        if (data) {\n          handleClick && handleClick();\n          resetForm();\n        }\n      });\n    }\n  };\n\n  return /*#__PURE__*/_jsx(Formik, {\n    initialValues: initialValues,\n    onSubmit: onSubmit,\n    validationSchema: validationSchema,\n    children: formik => {\n      return /*#__PURE__*/_jsxs(Form, {\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: css(styles.wrapper),\n          children: data ? /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(Avatar, {\n              avatar: data.avatar,\n              name: data.name,\n              size: \"S\"\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: css(styles.block),\n              children: /*#__PURE__*/_jsx(FormikControl, {\n                control: \"textarea\",\n                name: \"text\",\n                label: \"\\u0412\\u0430\\u0448 \\u043A\\u043E\\u043C\\u0435\\u043D\\u0442\\u0430\\u0440...\"\n              })\n            })]\n          }) : /*#__PURE__*/_jsxs(_Fragment, {\n            children: [/*#__PURE__*/_jsx(FontAwesomeIcon, {\n              className: css(styles.iconNoAvatar),\n              icon: faOptinMonster\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: css(styles.block),\n              children: /*#__PURE__*/_jsxs(\"p\", {\n                children: [\"\\u041F\\u0440\\u0438\\u0432\\u0456\\u0442! \\u0429\\u043E\\u0431 \\u043A\\u043E\\u043C\\u0435\\u043D\\u0442\\u0443\\u0432\\u0430\\u0442\\u0438, \\u043F\\u043E\\u0442\\u0440\\u0456\\u0431\\u043D\\u043E \", /*#__PURE__*/_jsx(Link, {\n                  href: \"/login\",\n                  children: /*#__PURE__*/_jsx(\"a\", {\n                    className: css(styles.link),\n                    children: \"\\u0443\\u0432\\u0456\\u0439\\u0442\\u0438\"\n                  })\n                })]\n              })\n            })]\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: css(loginStyles.inputSub, styles.submit, isFirstComment ? styles.submitPosition : null),\n          children: [isFirstComment || /*#__PURE__*/_jsx(ButtonLink, {\n            nameBtn: \"\\u0421\\u043A\\u0430\\u0441\\u0443\\u0432\\u0430\\u0442\\u0438\",\n            handleClick: handleClick\n          }), /*#__PURE__*/_jsx(Button, {\n            type: \"submit\",\n            nameBtn: \"\\u041A\\u043E\\u043C\\u0435\\u043D\\u0442\\u0443\\u0432\\u0430\\u0442\\u0438\",\n            isSubmitting: !data\n          })]\n        })]\n      });\n    }\n  });\n};","map":null,"metadata":{},"sourceType":"module"}