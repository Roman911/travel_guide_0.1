{"ast":null,"code":"import { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport React from \"react\";\nimport { useMutation } from \"@apollo/client\";\nimport { Formik, Form } from \"formik\";\nimport { useDispatch } from \"react-redux\";\nimport withApollo from \"../lib/withApollo\";\nimport { MainLayout, HeaderForm, AuthForm } from \"../Components\";\nimport { addUserMutation } from \"../apollo/mutations/addUser\";\nimport validateForm from '../utils/validate';\nimport { userActions, modalActions } from \"../redux/actions\";\n\nconst Registration = () => {\n  const dispatch = useDispatch();\n  const [createUse] = useMutation(addUserMutation);\n  const initialValues = {\n    name: '',\n    email: '',\n    password: '',\n    password2: ''\n  };\n\n  const validate = values => {\n    let errors = {};\n    validateForm({\n      values,\n      errors\n    });\n    return errors;\n  };\n\n  const onSubmit = (values, onSubmitProps) => {\n    createUse({\n      variables: {\n        userInput: {\n          name: values.name,\n          email: values.email,\n          password: values.password\n        }\n      }\n    }).then(data => {\n      if (data) {\n        // @ts-ignore\n        dispatch(userActions.registerData(data));\n        dispatch(modalActions.showModal('Користувач успішно створений! Увійдіть в свій акаунт'));\n      }\n\n      onSubmitProps.setSubmitting(false);\n    }).catch(errors => {\n      if (errors) {\n        dispatch(modalActions.showModal('Користувач з таким емейлом зайнятий'));\n      }\n\n      onSubmitProps.setSubmitting(false);\n    });\n  };\n\n  const dataForm = [{\n    control: 'input',\n    id: 'name',\n    type: 'text',\n    label: 'Ведіть імя'\n  }, {\n    control: 'input',\n    id: 'email',\n    type: 'email',\n    label: 'Введіть email'\n  }, {\n    control: 'input',\n    id: 'password',\n    type: 'password',\n    label: 'Придумайте пароль'\n  }, {\n    control: 'input',\n    id: 'password2',\n    type: 'password',\n    label: 'Повторіть пароль'\n  }];\n  return /*#__PURE__*/_jsxs(MainLayout, {\n    title: \"Registration\",\n    auth: true,\n    children: [/*#__PURE__*/_jsx(HeaderForm, {\n      title: \"\\u0420\\u0435\\u0454\\u0441\\u0442\\u0440\\u0430\\u0446\\u0456\\u044F\",\n      text: \"\\u0412\\u0436\\u0435 \\u0454 \\u0430\\u043A\\u0430\\u0443\\u043D\\u0442?\",\n      link: \"/login\",\n      btn: \"\\u0410\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u0443\\u0432\\u0430\\u0442\\u0438\\u0441\\u044F\"\n    }), /*#__PURE__*/_jsx(Formik, {\n      initialValues: initialValues,\n      onSubmit: onSubmit,\n      validate: validate,\n      children: formik => {\n        return /*#__PURE__*/_jsx(Form, {\n          children: /*#__PURE__*/_jsx(AuthForm, {\n            formik: formik,\n            dataForm: dataForm,\n            btn: \"\\u0421\\u0442\\u0432\\u043E\\u0440\\u0438\\u0442\\u0438 \\u0430\\u043A\\u0430\\u0443\\u043D\\u0442\"\n          })\n        });\n      }\n    })]\n  });\n};\n\nexport default withApollo(Registration);","map":null,"metadata":{},"sourceType":"module"}