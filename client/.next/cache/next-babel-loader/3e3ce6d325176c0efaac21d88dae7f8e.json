{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"D:\\\\web\\\\travel_guide\\\\client\\\\pages\\\\login.tsx\";\nimport React from \"react\";\nimport { useRouter } from \"next/router\";\nimport { useDispatch } from \"react-redux\";\nimport { Formik, Form } from 'formik';\nimport { useLazyQuery } from '@apollo/react-hooks';\nimport { loginQuery } from '../apollo/queries/login';\nimport validateForm from '../utils/validate';\nimport { Loading, MainLayout, HeaderForm, AuthForm } from \"../Components\";\nimport withApollo from \"../lib/withApollo\";\nimport { userActions, modalActions } from '../redux/actions';\n\nconst Login = () => {\n  const router = useRouter();\n  const dispatch = useDispatch();\n  const [userData, {\n    loading,\n    data,\n    error\n  }] = useLazyQuery(loginQuery);\n  const initialValues = {\n    email: '',\n    password: ''\n  };\n\n  const validate = values => {\n    let errors = {};\n    validateForm({\n      values,\n      errors\n    });\n    return errors;\n  };\n\n  const onSubmit = (values, onSubmitProps) => {\n    userData({\n      variables: {\n        email: values.email,\n        password: values.password\n      }\n    });\n    onSubmitProps.setSubmitting(false);\n  };\n\n  if (loading) return /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 28,\n    columnNumber: 23\n  }, this);\n\n  if (error) {\n    dispatch(modalActions.showModal('Неправильний логін або пароль'));\n  }\n\n  if (data) {\n    const {\n      login\n    } = data;\n    dispatch(userActions.setData(login));\n    localStorage.setItem('userData', JSON.stringify({\n      userId: login.userId,\n      token: login.token,\n      name: login.name,\n      avatar: login.avatar,\n      email: login.email\n    }));\n    dispatch(modalActions.showModal('Ви успішно увійшли!'));\n    router.push('/').then(r => r);\n  }\n\n  const dataForm = [{\n    control: 'input',\n    id: 'email',\n    type: 'email',\n    label: 'Введіть email'\n  }, {\n    control: 'input',\n    id: 'password',\n    type: 'password',\n    label: 'Введіть пароль'\n  }];\n  return /*#__PURE__*/_jsxDEV(MainLayout, {\n    title: \"\\u0412\\u0445\\u0456\\u0434\",\n    auth: true,\n    children: [/*#__PURE__*/_jsxDEV(HeaderForm, {\n      title: \"\\u0412\\u0445\\u0456\\u0434\",\n      text: \"\\u0423 \\u0432\\u0430\\u0441 \\u0449\\u0435 \\u043D\\u0435\\u043C\\u0430 \\u0430\\u043A\\u0430\\u0443\\u043D\\u0442\\u0430?\",\n      link: \"/registration\",\n      btn: \"\\u0421\\u0442\\u0432\\u043E\\u0440\\u0438\\u0442\\u0438\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(Formik, {\n      initialValues: initialValues,\n      onSubmit: onSubmit,\n      validate: validate,\n      children: formik => {\n        return /*#__PURE__*/_jsxDEV(Form, {\n          children: /*#__PURE__*/_jsxDEV(AuthForm, {\n            formik: formik,\n            dataForm: dataForm,\n            btn: \"\\u0423\\u0432\\u0456\\u0439\\u0442\\u0438\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 62,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 16\n        }, this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 10\n  }, this);\n};\n\nexport default withApollo(Login);","map":{"version":3,"sources":["D:/web/travel_guide/client/pages/login.tsx"],"names":["React","useRouter","useDispatch","Formik","Form","useLazyQuery","loginQuery","validateForm","Loading","MainLayout","HeaderForm","AuthForm","withApollo","userActions","modalActions","Login","router","dispatch","userData","loading","data","error","initialValues","email","password","validate","values","errors","onSubmit","onSubmitProps","variables","setSubmitting","showModal","login","setData","localStorage","setItem","JSON","stringify","userId","token","name","avatar","push","then","r","dataForm","control","id","type","label","formik"],"mappings":"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","sourcesContent":["import React from \"react\"\r\nimport { useRouter } from \"next/router\"\r\nimport { useDispatch } from \"react-redux\"\r\nimport { Formik, Form } from 'formik'\r\nimport { useLazyQuery } from '@apollo/react-hooks'\r\nimport { loginQuery } from '../apollo/queries/login'\r\nimport validateForm from '../utils/validate'\r\nimport { Loading, MainLayout, HeaderForm, AuthForm } from \"../Components\"\r\nimport withApollo from \"../lib/withApollo\"\r\nimport { userActions, modalActions } from '../redux/actions'\r\n\r\nconst Login: React.FC = () => {\r\n  const router = useRouter()\r\n  const dispatch = useDispatch()\r\n  const [ userData, { loading, data, error } ] = useLazyQuery( loginQuery )\r\n  const initialValues = { email: '', password: '' }\r\n  const validate = values => {\r\n    let errors = {}\r\n    validateForm({ values, errors })\r\n    return errors\r\n  }\r\n  const onSubmit = (values, onSubmitProps) => {\r\n    userData({\r\n      variables: { email: values.email, password: values.password },\r\n    })\r\n    onSubmitProps.setSubmitting(false)\r\n  }\r\n  if (loading) return <Loading />\r\n  if (error) {\r\n    dispatch(modalActions.showModal('Неправильний логін або пароль'))\r\n  }\r\n  if (data) {\r\n    const { login } = data\r\n    dispatch(userActions.setData(login))\r\n    localStorage.setItem('userData', JSON.stringify({\r\n      userId: login.userId, token: login.token, name: login.name, avatar: login.avatar, email: login.email\r\n    }))\r\n    dispatch(modalActions.showModal('Ви успішно увійшли!'))\r\n    router.push('/').then(r => r)\r\n  }\r\n\r\n  const dataForm = [\r\n    {\r\n      control: 'input',\r\n      id: 'email',\r\n      type: 'email',\r\n      label: 'Введіть email'\r\n    },\r\n    {\r\n      control: 'input',\r\n      id: 'password',\r\n      type: 'password',\r\n      label: 'Введіть пароль'\r\n    }\r\n  ]\r\n\r\n  return <MainLayout title='Вхід' auth={ true } >\r\n    <HeaderForm title='Вхід' text='У вас ще нема акаунта?' link='/registration' btn='Створити' />\r\n    <Formik initialValues={ initialValues } onSubmit={ onSubmit } validate={ validate } >\r\n      {formik => {\r\n        return <Form>\r\n          <AuthForm formik={ formik } dataForm={ dataForm } btn='Увійти' />\r\n        </Form>\r\n      }}\r\n    </Formik>\r\n  </MainLayout>\r\n}\r\n\r\nexport default withApollo(Login)"]},"metadata":{},"sourceType":"module"}